# Bloque III: Lógica Condicional y Referencias Fijas

Este bloque te enseña a crear hojas de cálculo inteligentes que pueden tomar decisiones basadas en los datos (Lógica Condicional) y cómo asegurar que tus fórmulas funcionen correctamente cuando las copias (Referencias).

## 1. Referencias: ¿Qué Fijo y Qué Muevo?

Cuando trabajamos con fórmulas, es vital entender cómo se comportan las referencias de celda cuando copiamos esa fórmula a otras celdas.

### I. Referencia Relativa (Automática)

La Referencia Relativa es la forma en que Google Sheets trabaja por defecto.

* **Definición:** Cuando copias una fórmula a una celda vecina, las referencias a las filas y columnas se **ajustan automáticamente** para mantener la misma posición relativa.
* **Uso Práctico:** Se utiliza cuando quieres aplicar la misma operación a datos diferentes en cada fila.
* **Ejemplo:** Para calcular la **Media** de las notas de los exámenes de varios estudiantes, la fórmula en la celda D2 es `=PROMEDIO(B2:C2)`. Si arrastras esta fórmula hacia abajo a D3, automáticamente cambia a `=PROMEDIO(B3:C3)`, adaptándose a los datos del siguiente estudiante.

### II. Referencia Absoluta (Fija)

La Referencia Absoluta se usa cuando un valor específico **nunca debe cambiar** al copiar la fórmula.

* **Sintaxis:** Se indica con el signo del **dólar (`$`)** antes de la letra de la columna y el número de la fila (ej: `$H$1`).
* **Uso Práctico:** Se utiliza para mantener fijo un valor clave, como una tasa de impuestos o un bono fijo.
* **Ejemplo (Calificaciones):** Si quieres calcular la nota **Final** sumando un valor **Extra** fijo (por ejemplo, 0,5) a la nota Media, y ese valor extra está en la celda H1, la fórmula debe ser `=D2+$H$1`. Al copiar esta fórmula, la referencia a `$H$1` **permanecerá fija**, mientras que la referencia a `D2` (la nota media) cambiará de forma relativa (D3, D4, etc.).
* **Ejemplo (IVA):** Si calculas el **IVA del Importe**, donde el porcentaje de IVA (`21,00%`) está en la celda `E1`, la fórmula debe ser `=D3*$E$1`. El `D3` (el importe) es relativo, pero el `$E$1` (el porcentaje) es absoluto para que se aplique correctamente a todos los artículos.

---

## 2. Lógica Condicional (Tomar Decisiones)

La lógica condicional permite que la hoja de cálculo realice una **evaluación** de un dato y tome una **decisión** automática sobre qué mostrar o qué acción realizar.

### I. La Función SI (IF)

La función `SI` es la herramienta fundamental para automatizar decisiones. Evalúa si una condición es verdadera o falsa y devuelve un resultado correspondiente.

* **Propósito:** Automatiza decisiones y clasifica datos.
* **Sintaxis:** `=SI(expresión_lógica, valor_si_verdadero, valor_si_falso)`.
* La **`expresión_lógica`** es la condición que se evalúa (ej. `B2 >= 50`).
    *El **`valor_si_verdadero`** es el resultado si la condición es cierta (TRUE).
  * El **`valor_si_falso`** es el resultado si la condición es falsa (FALSE).
* **Importante:** Cuando se especifican textos como resultados (ej. "Aprobado", "Suspenso"), deben ir **entre comillas dobles**.
* **Ejemplos de Aplicación:**
  * **Calificaciones:** Determinar si un alumno está "**Aprobado**" o "**Suspenso**" basándose en una nota (ej. si la nota es mayor o igual a 5).
  * **Clima:** Determinar si la presión atmosférica resulta en una "**Borrasca**" (presión menor o igual a 1000 mb) o un "**Anticiclón**" (presión mayor a 1000 mb).
  * **Bonificaciones:** Si las horas trabajadas son `>30`, se devuelve "**Bonus**"; si no, "**No Bonus**".
  * **Validación de Datos:** Puede usarse junto con funciones como `ISTEXT` para verificar si una celda contiene texto.

### II. Operadores Lógicos Avanzados (AND / OR)

Para condiciones más complejas, la función `SI` se combina con los operadores `Y` (AND) u `O` (OR).

* **Y (AND):** Devuelve `VERDADERO` (TRUE) solo si **todas** las condiciones especificadas son ciertas.
* **O (OR):** Devuelve `VERDADERO` (TRUE) si **al menos una** de las condiciones es cierta.

---

## 3. Conteo Condicional y Formato Automático

Estas funciones te permiten resumir grandes conjuntos de datos de forma automática.

### I. Conteo Condicional (Función CONTAR.SI / COUNTIF)

La función `CONTAR.SI` se utiliza para **contar el número de celdas** dentro de un rango que cumplen con un **criterio específico**.

* **Uso Práctico:** Se utiliza para determinar, por ejemplo, el **Nº de Alumnos Aprobados** o el **Nº de Alumnos Suspensos** en una asignatura, basándose en los resultados de la Función SI.
* **Diferencia con CONTAR:** `CONTAR()` solo cuenta las celdas que contienen números, mientras que `CONTAR.SI` cuenta las celdas que cumplen una condición lógica (ej. contar solo las celdas que dicen "Aprobado" o que contienen un número mayor a 5).

### II. Formato Condicional

El Formato Condicional aplica estilos visuales (como colores) a una celda **automáticamente** si el valor de esa celda cumple una **condición lógica** o regla predefinida.

* **Diferencia del Formato Manual:** En el Bloque I, aplicaste colores manualmente. El Formato Condicional es automático y dinámico: si el dato cambia, el color cambia con él.
* **Ejemplo:** Se utiliza para mostrar las notas **iguales o superiores a 5 en color verde**, mientras que las **inferiores a 5 se muestran en rojo**. Esto permite una visualización inmediata del rendimiento sin necesidad de revisar cada número.
